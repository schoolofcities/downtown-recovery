import{S as hr,i as dr,s as ur,y as fr,a as C,k as v,q as c,K as V,z as vr,c as D,l as _,m as d,r as h,h as i,L as q,n as t,p as Nt,A as _r,b as me,C as e,g as mr,d as yr,B as pr,o as gr,M as Pt,D as Le,V as wr,X as br,u as er,J as cr}from"../chunks/index.5885d984.js";import{H as kr}from"../chunks/global.4dde8b47.js";import"../chunks/transform.4d2927c0.js";import{m as tr,l as xr,d as Er,u as Cr}from"../chunks/red-arrow.6fc67973.js";import{c as rr}from"../chunks/stores.01dfc0ed.js";import{t as Dr,l as Tr}from"../chunks/line.277d9777.js";import{m as Ir,a as Mr}from"../chunks/min.d247b692.js";import{t as Nr}from"../chunks/time.13603cc8.js";import{l as Pr}from"../chunks/linear.6154f0ba.js";import{c as Sr}from"../chunks/csv.3ac754ad.js";const Vr=!0,ta=Object.freeze(Object.defineProperty({__proto__:null,prerender:Vr},Symbol.toStringTag,{value:"Module"}));function ar(o,r,l){const s=o.slice();return s[12]=r[l].city,s[13]=r[l].regressionLine,s[14]=r[l].startCircle,s[15]=r[l].endCircle,s[16]=r[l].meanLine,s[17]=r[l].perChangeDisplay,s[18]=r[l].percentageChange,s[20]=l,s}function lr(o,r,l){const s=o.slice();return s[21]=r[l],s[20]=l,s}function or(o,r,l){const s=o.slice();return s[21]=r[l],s[20]=l,s}function qr(o){let r,l,s,n,u,y,W,p,Z,x,te=o[3].monthNumber+"",R,Q,re=o[3].year2+"",g,w,N=o[3].monthNumber+"",Y,J,G=o[3].year1+"",T,b,F=o[3].year1+"",oe,P,ae=o[3].year2+"",z,I,L,A,se=[2,3,4,5,6,7,8,9,10,11,12,1,2],S=[];for(let m=0;m<13;m+=1)S[m]=sr(or(o,se,m));let le=o[2],E=[];for(let m=0;m<le.length;m+=1)E[m]=ir(ar(o,le,m));return{c(){r=v("div"),l=v("div"),s=v("div"),n=v("div"),u=V("svg"),y=V("text"),W=c("City"),p=V("text"),Z=c("Percent Change in Unique Devices"),x=V("text"),R=c(te),Q=c("/"),g=c(re),w=c(" vs. "),Y=c(N),J=c("/"),T=c(G),b=V("text"),oe=c(F),P=V("text"),z=c(ae),I=V("line");for(let m=0;m<13;m+=1)S[m].c();L=V("line"),A=C();for(let m=0;m<E.length;m+=1)E[m].c();this.h()},l(m){r=_(m,"DIV",{class:!0});var U=d(r);l=_(U,"DIV",{class:!0});var a=d(l);s=_(a,"DIV",{class:!0});var B=d(s);n=_(B,"DIV",{class:!0});var j=d(n);u=q(j,"svg",{width:!0,height:!0,class:!0});var f=d(u);y=q(f,"text",{x:!0,y:!0,class:!0});var k=d(y);W=h(k,"City"),k.forEach(i),p=q(f,"text",{x:!0,y:!0,class:!0});var M=d(p);Z=h(M,"Percent Change in Unique Devices"),M.forEach(i),x=q(f,"text",{x:!0,y:!0,class:!0});var O=d(x);R=h(O,te),Q=h(O,"/"),g=h(O,re),w=h(O," vs. "),Y=h(O,N),J=h(O,"/"),T=h(O,G),O.forEach(i),b=q(f,"text",{x:!0,y:!0,class:!0});var ue=d(b);oe=h(ue,F),ue.forEach(i),P=q(f,"text",{x:!0,y:!0,class:!0});var be=d(P);z=h(be,ae),be.forEach(i),I=q(f,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(I).forEach(i);for(let ne=0;ne<13;ne+=1)S[ne].l(f);L=q(f,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(L).forEach(i),f.forEach(i),j.forEach(i),B.forEach(i),A=D(a);for(let ne=0;ne<E.length;ne+=1)E[ne].l(a);a.forEach(i),U.forEach(i),this.h()},h(){t(y,"x","12"),t(y,"y","35"),t(y,"class","textCity svelte-td4yl0"),t(p,"x","235"),t(p,"y","15"),t(p,"class","textLabel svelte-td4yl0"),t(x,"x","235"),t(x,"y","35"),t(x,"class","textLabel svelte-td4yl0"),t(b,"x",260+(13-o[3].monthNumber)/2*K/13),t(b,"y","15"),t(b,"class","textMonth svelte-td4yl0"),t(P,"x",260+(13-o[3].monthNumber)*K/13+o[3].monthNumber/2*K/13),t(P,"y","15"),t(P,"class","textMonth svelte-td4yl0"),t(I,"x1","260"),t(I,"y1",45),t(I,"x2",260+K),t(I,"y2",45),t(I,"stroke","white"),t(I,"stroke-width","1"),t(L,"x1",259+K),t(L,"y1",45),t(L,"x2",259+K),t(L,"y2",40),t(L,"stroke","white"),t(L,"stroke-width","1"),t(u,"width","760"),t(u,"height",Ve),t(u,"class","region-bar"),t(n,"class","left svelte-td4yl0"),t(s,"class","chart-wrapper svelte-td4yl0"),t(l,"class","charts-inner svelte-td4yl0"),t(r,"class","charts-scroll-container svelte-td4yl0")},m(m,U){me(m,r,U),e(r,l),e(l,s),e(s,n),e(n,u),e(u,y),e(y,W),e(u,p),e(p,Z),e(u,x),e(x,R),e(x,Q),e(x,g),e(x,w),e(x,Y),e(x,J),e(x,T),e(u,b),e(b,oe),e(u,P),e(P,z),e(u,I);for(let a=0;a<13;a+=1)S[a]&&S[a].m(u,null);e(u,L),e(l,A);for(let a=0;a<E.length;a+=1)E[a]&&E[a].m(l,null)},p(m,U){if(U&0){se=[2,3,4,5,6,7,8,9,10,11,12,1,2];let a;for(a=0;a<13;a+=1){const B=or(m,se,a);S[a]?S[a].p(B,U):(S[a]=sr(B),S[a].c(),S[a].m(u,L))}for(;a<13;a+=1)S[a].d(1)}if(U&6){le=m[2];let a;for(a=0;a<le.length;a+=1){const B=ar(m,le,a);E[a]?E[a].p(B,U):(E[a]=ir(B),E[a].c(),E[a].m(l,null))}for(;a<E.length;a+=1)E[a].d(1);E.length=le.length}},d(m){m&&i(r),Pt(S,m),Pt(E,m)}}}function zr(o){let r,l,s,n,u;return{c(){r=v("div"),l=v("div"),s=C(),n=v("p"),u=c("Loading data..."),this.h()},l(y){r=_(y,"DIV",{class:!0});var W=d(r);l=_(W,"DIV",{class:!0}),d(l).forEach(i),s=D(W),n=_(W,"P",{class:!0});var p=d(n);u=h(p,"Loading data..."),p.forEach(i),W.forEach(i),this.h()},h(){t(l,"class","loading-spinner svelte-td4yl0"),t(n,"class","loading-text svelte-td4yl0"),t(r,"class","loading-container svelte-td4yl0")},m(y,W){me(y,r,W),e(r,l),e(r,s),e(r,n),e(n,u)},p:Le,d(y){y&&i(r)}}}function Lr(o){let r;return{c(){r=V("line"),this.h()},l(l){r=q(l,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(r).forEach(i),this.h()},h(){t(r,"x1",260+o[20]*K/13),t(r,"y1",5),t(r,"x2",260+o[20]*K/13),t(r,"y2",40),t(r,"stroke","white"),t(r,"stroke-width","1")},m(l,s){me(l,r,s)},p:Le,d(l){l&&i(r)}}}function sr(o){let r,l,s,n=o[21]===1&&Lr(o);return{c(){r=V("line"),n&&n.c(),l=V("text"),s=c(o[21]),this.h()},l(u){r=q(u,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(r).forEach(i),n&&n.l(u),l=q(u,"text",{x:!0,y:!0,class:!0});var y=d(l);s=h(y,o[21]),y.forEach(i),this.h()},h(){t(r,"x1",260+o[20]*K/13),t(r,"y1",45),t(r,"x2",260+o[20]*K/13),t(r,"y2",40),t(r,"stroke","white"),t(r,"stroke-width","1"),t(l,"x",260+o[20]*K/13+.5*K/13),t(l,"y","40"),t(l,"class","textMonth svelte-td4yl0")},m(u,y){me(u,r,y),n&&n.m(u,y),me(u,l,y),e(l,s)},p(u,y){u[21]===1&&n.p(u,y)},d(u){u&&i(r),n&&n.d(u),u&&i(l)}}}function Ar(o){let r,l;return{c(){r=v("img"),this.h()},l(s){r=_(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){cr(r.src,l=Er)||t(r,"src",l),t(r,"alt","Down arrow"),t(r,"class","arrow-icon svelte-td4yl0")},m(s,n){me(s,r,n)},p:Le,d(s){s&&i(r)}}}function Ur(o){let r,l;return{c(){r=v("img"),this.h()},l(s){r=_(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){cr(r.src,l=Cr)||t(r,"src",l),t(r,"alt","Up arrow"),t(r,"class","arrow-icon svelte-td4yl0")},m(s,n){me(s,r,n)},p:Le,d(s){s&&i(r)}}}function nr(o){let r;return{c(){r=V("line"),this.h()},l(l){r=q(l,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(r).forEach(i),this.h()},h(){t(r,"x1",o[21]*K/13),t(r,"y1",5),t(r,"x2",o[21]*K/13),t(r,"y2",45),t(r,"stroke","#333333"),t(r,"stroke-width","1")},m(l,s){me(l,r,s)},p:Le,d(l){l&&i(r)}}}function ir(o){let r,l,s,n,u,y=o[20]+1+"",W,p,Z=o[12]+"",x,te,R,Q,re,g,w,N=o[17]+"",Y,J,G,T,b,F,oe,P,ae,z,I,L,A,se,S,le,E;function m(f,k){if(f[18]>0)return Ur;if(f[18]<0)return Ar}let U=m(o),a=U&&U(o),B=[1,2,3,4,5,6,7,8,9,10,11,12],j=[];for(let f=0;f<12;f+=1)j[f]=nr(lr(o,B,f));return{c(){r=v("div"),l=v("div"),s=V("svg"),n=V("line"),u=V("text"),W=c(y),p=c(". "),x=c(Z),te=C(),R=v("div"),a&&a.c(),Q=C(),re=v("div"),g=V("svg"),w=V("text"),Y=c(N),J=C(),G=v("div"),T=V("svg");for(let f=0;f<12;f+=1)j[f].c();b=V("line"),P=V("path"),z=V("circle"),A=V("circle"),le=C(),this.h()},l(f){r=_(f,"DIV",{class:!0});var k=d(r);l=_(k,"DIV",{class:!0});var M=d(l);s=q(M,"svg",{width:!0,height:!0,class:!0});var O=d(s);n=q(O,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),d(n).forEach(i),u=q(O,"text",{x:!0,y:!0,class:!0});var ue=d(u);W=h(ue,y),p=h(ue,". "),x=h(ue,Z),ue.forEach(i),O.forEach(i),M.forEach(i),te=D(k),R=_(k,"DIV",{class:!0});var be=d(R);a&&a.l(be),be.forEach(i),Q=D(k),re=_(k,"DIV",{class:!0});var ne=d(re);g=q(ne,"svg",{width:!0,height:!0,class:!0});var Te=d(g);w=q(Te,"text",{x:!0,y:!0,class:!0});var qe=d(w);Y=h(qe,N),qe.forEach(i),Te.forEach(i),ne.forEach(i),J=D(k),G=_(k,"DIV",{class:!0,style:!0});var Ie=d(G);T=q(Ie,"svg",{height:!0,width:!0,class:!0});var ye=d(T);for(let xe=0;xe<12;xe+=1)j[xe].l(ye);b=q(ye,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,"stroke-dasharray":!0}),d(b).forEach(i),P=q(ye,"path",{d:!0,stroke:!0,"stroke-width":!0,fill:!0}),d(P).forEach(i),z=q(ye,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),d(z).forEach(i),A=q(ye,"circle",{cx:!0,cy:!0,r:!0,fill:!0,stroke:!0}),d(A).forEach(i),ye.forEach(i),Ie.forEach(i),le=D(k),k.forEach(i),this.h()},h(){t(n,"x1","5"),t(n,"y1","15"),t(n,"x2","5"),t(n,"y2",Ve-15),t(n,"stroke","#fff"),t(n,"stroke-width","5"),t(u,"x","12"),t(u,"y","31"),t(u,"class","textCity svelte-td4yl0"),t(s,"width","150"),t(s,"height",Ve),t(s,"class","region-bar"),t(l,"class","left svelte-td4yl0"),t(R,"class","arrow svelte-td4yl0"),t(w,"x","50"),t(w,"y","45"),t(w,"class","textPercent svelte-td4yl0"),t(g,"width","50"),t(g,"height",Ve),t(g,"class","region-bar"),t(re,"class","number svelte-td4yl0"),t(b,"x1","0"),t(b,"y1",F=o[16]),t(b,"x2",K),t(b,"y2",oe=o[16]),t(b,"stroke","#D0D1C9"),t(b,"stroke-width","1"),t(b,"stroke-dasharray","4"),t(P,"d",ae=o[13]),t(P,"stroke","white"),t(P,"stroke-width","2"),t(P,"fill","none"),t(z,"cx",I=o[14].cx),t(z,"cy",L=o[14].cy),t(z,"r","2"),t(z,"fill","white"),t(A,"cx",se=o[15].cx),t(A,"cy",S=o[15].cy),t(A,"r","2"),t(A,"fill","white"),t(A,"stroke","white"),t(T,"height",Ve),t(T,"width",K),t(T,"class","chart svelte-td4yl0"),t(G,"class","chart-container svelte-td4yl0"),Nt(G,"width",K),t(r,"class","chart-wrapper svelte-td4yl0"),wr(()=>o[9].call(r))},m(f,k){me(f,r,k),e(r,l),e(l,s),e(s,n),e(s,u),e(u,W),e(u,p),e(u,x),e(r,te),e(r,R),a&&a.m(R,null),e(r,Q),e(r,re),e(re,g),e(g,w),e(w,Y),e(r,J),e(r,G),e(G,T);for(let M=0;M<12;M+=1)j[M]&&j[M].m(T,null);e(T,b),e(T,P),e(T,z),e(T,A),e(r,le),E=br(r,o[9].bind(r))},p(f,k){if(k&4&&Z!==(Z=f[12]+"")&&er(x,Z),U===(U=m(f))&&a?a.p(f,k):(a&&a.d(1),a=U&&U(f),a&&(a.c(),a.m(R,null))),k&4&&N!==(N=f[17]+"")&&er(Y,N),k&0){B=[1,2,3,4,5,6,7,8,9,10,11,12];let M;for(M=0;M<12;M+=1){const O=lr(f,B,M);j[M]?j[M].p(O,k):(j[M]=nr(O),j[M].c(),j[M].m(T,b))}for(;M<12;M+=1)j[M].d(1)}k&4&&F!==(F=f[16])&&t(b,"y1",F),k&4&&oe!==(oe=f[16])&&t(b,"y2",oe),k&4&&ae!==(ae=f[13])&&t(P,"d",ae),k&4&&I!==(I=f[14].cx)&&t(z,"cx",I),k&4&&L!==(L=f[14].cy)&&t(z,"cy",L),k&4&&se!==(se=f[15].cx)&&t(A,"cx",se),k&4&&S!==(S=f[15].cy)&&t(A,"cy",S)},d(f){f&&i(r),a&&a.d(),Pt(j,f),E()}}}function Br(o){let r,l,s,n,u,y,W,p,Z,x,te,R,Q,re,g,w,N,Y,J,G,T,b,F,oe,P=o[3].update_date+"",ae,z,I,L,A=o[3].year2+"",se,S,le=o[3].year1+"",E,m,U,a,B,j=o[3].monthName+"",f,k,M=o[3].year1+"",O,ue,be=o[3].monthName+"",ne,Te,qe=o[3].year1+"",Ie,ye,xe,ge,Ge,St=o[3].year2+"",Fe,He,Vt=o[3].year1+"",We,Je,Re,X,Oe,qt=o[3].monthName+"",Ye,je,zt=o[3].day1_num+"",Ke,Ze,Lt=o[3].year1+"",Qe,Xe,At=o[3].monthName+"",$e,et,Ut=o[3].day2_num+"",tt,rt,Bt=o[3].year2+"",at,lt,ot,he,Ee,fe,st,Gt=o[3].monthName+"",nt,it,Ft=o[3].year1+"",ct,ht,dt,Ae,$,ut,ft,vt,_t,ze,mt,yt,ve,pt,Me,gt,wt,Ne,bt,kt,Ce,xt,Et,Ct,Dt,Tt,It,Ue;r=new kr({});function Ht(H,ce){return H[0]?zr:qr}let Be=Ht(o),_e=Be(o);return{c(){fr(r.$$.fragment),l=C(),s=v("main"),n=v("div"),u=v("h1"),y=c("Canada Recovery Trends"),W=C(),p=v("p"),Z=c("By "),x=v("a"),te=c("Karen Chapple"),R=c(", "),Q=v("a"),re=c("Julia Greenberg"),g=c(", "),w=v("a"),N=c("Jeff Allen"),Y=c(", "),J=v("a"),G=c("Irene Chang"),T=C(),b=v("p"),F=v("i"),oe=c("Updated "),ae=c(P),z=C(),I=v("p"),L=c("Data on cell phone activity (a.k.a. footfall) trends for the last year provide a picture of how Canadian downtowns are faring. We look here at year-over-year ("),se=c(A),S=c(" vs. "),E=c(le),m=c(") trends."),U=C(),a=v("p"),B=c("The solid line represents the number of daily unique devices in the downtown area. The dotted line provides a baseline of the average level of activity in "),f=c(j),k=C(),O=c(M),ue=c(", allowing for comparison to subsequent months. When the solid line extends above the dotted baseline, downtown activity is greater compared to in "),ne=c(be),Te=C(),Ie=c(qe),ye=c(". When it dips below the dotted line, activity is on a downswing."),xe=C(),ge=v("p"),Ge=c("Note: Trends are based on data from Spectus, but use different cell phone data providers from our rankings analysis. The trendlines measure the average level of activity over the course of the year, while the ranking metric shows the percent difference in the average number of unique devices in "),Fe=c(St),He=c(" versus the same month in "),We=c(Vt),Je=c("."),Re=C(),X=v("h4"),Oe=c("Unique Devices Downtown ("),Ye=c(qt),je=C(),Ke=c(zt),Ze=c(", "),Qe=c(Lt),Xe=c(" to "),$e=c(At),et=C(),tt=c(Ut),rt=c(", "),at=c(Bt),lt=c(")"),ot=C(),he=v("p"),Ee=V("svg"),fe=V("line"),st=C(),nt=c(Gt),it=C(),ct=c(Ft),ht=c(" average"),dt=C(),_e.c(),Ae=C(),$=v("div"),ut=v("br"),ft=C(),vt=v("br"),_t=C(),ze=v("h4"),mt=c("More Information"),yt=C(),ve=v("p"),pt=c("The trend lines are fit from daily data via a "),Me=v("a"),gt=c("LOESS"),wt=c(" curve. You can download the raw daily data shown to fit these curves "),Ne=v("a"),bt=c("from this link"),kt=c(". The data on the charts are based on the `normalized_distinct_clean` column, which pertains to the number of unique daily devices normalized by the total number in the metro area. The trend-line and summary statistics shown are calculated in JavaScript (code is on "),Ce=v("a"),xt=c("GitHub"),Et=c(")"),Ct=C(),Dt=v("br"),Tt=C(),It=v("br"),this.h()},l(H){vr(r.$$.fragment,H),l=D(H),s=_(H,"MAIN",{});var ce=d(s);n=_(ce,"DIV",{class:!0});var ee=d(n);u=_(ee,"H1",{});var Wt=d(u);y=h(Wt,"Canada Recovery Trends"),Wt.forEach(i),W=D(ee),p=_(ee,"P",{});var we=d(p);Z=h(we,"By "),x=_(we,"A",{href:!0});var Jt=d(x);te=h(Jt,"Karen Chapple"),Jt.forEach(i),R=h(we,", "),Q=_(we,"A",{href:!0});var Rt=d(Q);re=h(Rt,"Julia Greenberg"),Rt.forEach(i),g=h(we,", "),w=_(we,"A",{href:!0});var Ot=d(w);N=h(Ot,"Jeff Allen"),Ot.forEach(i),Y=h(we,", "),J=_(we,"A",{href:!0});var Yt=d(J);G=h(Yt,"Irene Chang"),Yt.forEach(i),we.forEach(i),T=D(ee),b=_(ee,"P",{});var jt=d(b);F=_(jt,"I",{});var Mt=d(F);oe=h(Mt,"Updated "),ae=h(Mt,P),Mt.forEach(i),jt.forEach(i),z=D(ee),I=_(ee,"P",{});var Pe=d(I);L=h(Pe,"Data on cell phone activity (a.k.a. footfall) trends for the last year provide a picture of how Canadian downtowns are faring. We look here at year-over-year ("),se=h(Pe,A),S=h(Pe," vs. "),E=h(Pe,le),m=h(Pe,") trends."),Pe.forEach(i),U=D(ee),a=_(ee,"P",{});var pe=d(a);B=h(pe,"The solid line represents the number of daily unique devices in the downtown area. The dotted line provides a baseline of the average level of activity in "),f=h(pe,j),k=D(pe),O=h(pe,M),ue=h(pe,", allowing for comparison to subsequent months. When the solid line extends above the dotted baseline, downtown activity is greater compared to in "),ne=h(pe,be),Te=D(pe),Ie=h(pe,qe),ye=h(pe,". When it dips below the dotted line, activity is on a downswing."),pe.forEach(i),xe=D(ee),ge=_(ee,"P",{});var Se=d(ge);Ge=h(Se,"Note: Trends are based on data from Spectus, but use different cell phone data providers from our rankings analysis. The trendlines measure the average level of activity over the course of the year, while the ranking metric shows the percent difference in the average number of unique devices in "),Fe=h(Se,St),He=h(Se," versus the same month in "),We=h(Se,Vt),Je=h(Se,"."),Se.forEach(i),Re=D(ee),X=_(ee,"H4",{});var ie=d(X);Oe=h(ie,"Unique Devices Downtown ("),Ye=h(ie,qt),je=D(ie),Ke=h(ie,zt),Ze=h(ie,", "),Qe=h(ie,Lt),Xe=h(ie," to "),$e=h(ie,At),et=D(ie),tt=h(ie,Ut),rt=h(ie,", "),at=h(ie,Bt),lt=h(ie,")"),ie.forEach(i),ot=D(ee),he=_(ee,"P",{style:!0});var De=d(he);Ee=q(De,"svg",{height:!0,width:!0});var Kt=d(Ee);fe=q(Kt,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,"stroke-dasharray":!0}),d(fe).forEach(i),Kt.forEach(i),st=D(De),nt=h(De,Gt),it=D(De),ct=h(De,Ft),ht=h(De," average"),De.forEach(i),ee.forEach(i),dt=D(ce),_e.l(ce),Ae=D(ce),$=_(ce,"DIV",{class:!0});var de=d($);ut=_(de,"BR",{}),ft=D(de),vt=_(de,"BR",{}),_t=D(de),ze=_(de,"H4",{});var Zt=d(ze);mt=h(Zt,"More Information"),Zt.forEach(i),yt=D(de),ve=_(de,"P",{});var ke=d(ve);pt=h(ke,"The trend lines are fit from daily data via a "),Me=_(ke,"A",{href:!0});var Qt=d(Me);gt=h(Qt,"LOESS"),Qt.forEach(i),wt=h(ke," curve. You can download the raw daily data shown to fit these curves "),Ne=_(ke,"A",{href:!0});var Xt=d(Ne);bt=h(Xt,"from this link"),Xt.forEach(i),kt=h(ke,". The data on the charts are based on the `normalized_distinct_clean` column, which pertains to the number of unique daily devices normalized by the total number in the metro area. The trend-line and summary statistics shown are calculated in JavaScript (code is on "),Ce=_(ke,"A",{href:!0,target:!0});var $t=d(Ce);xt=h($t,"GitHub"),$t.forEach(i),Et=h(ke,")"),ke.forEach(i),Ct=D(de),Dt=_(de,"BR",{}),Tt=D(de),It=_(de,"BR",{}),de.forEach(i),ce.forEach(i),this.h()},h(){t(x,"href","https://schoolofcities.utoronto.ca/people/karen-chapple/"),t(Q,"href","https://www.urbandisplacement.org/team/julia-greenberg/"),t(w,"href","https://schoolofcities.utoronto.ca/people/jeff-allen/"),t(J,"href","https://www.linkedin.com/in/irene-kcc/"),t(fe,"x1","0"),t(fe,"y1","5"),t(fe,"x2","50"),t(fe,"y2","5"),t(fe,"stroke","white"),t(fe,"stroke-width","1"),t(fe,"stroke-dasharray","4"),t(Ee,"height","10"),t(Ee,"width","50"),Nt(he,"padding-top","10px"),Nt(he,"padding-bottom","10px"),t(n,"class","text svelte-td4yl0"),t(Me,"href","https://en.wikipedia.org/wiki/Local_regression"),t(Ne,"href","/trend_canada_feb1_2024_to_feb28_2025.csv"),t(Ce,"href","https://github.com/schoolofcities/downtown-recovery/blob/main/src/routes/charts/canada_trends/%2Bpage.svelte"),t(Ce,"target","_blank"),t($,"class","text svelte-td4yl0")},m(H,ce){_r(r,H,ce),me(H,l,ce),me(H,s,ce),e(s,n),e(n,u),e(u,y),e(n,W),e(n,p),e(p,Z),e(p,x),e(x,te),e(p,R),e(p,Q),e(Q,re),e(p,g),e(p,w),e(w,N),e(p,Y),e(p,J),e(J,G),e(n,T),e(n,b),e(b,F),e(F,oe),e(F,ae),e(n,z),e(n,I),e(I,L),e(I,se),e(I,S),e(I,E),e(I,m),e(n,U),e(n,a),e(a,B),e(a,f),e(a,k),e(a,O),e(a,ue),e(a,ne),e(a,Te),e(a,Ie),e(a,ye),e(n,xe),e(n,ge),e(ge,Ge),e(ge,Fe),e(ge,He),e(ge,We),e(ge,Je),e(n,Re),e(n,X),e(X,Oe),e(X,Ye),e(X,je),e(X,Ke),e(X,Ze),e(X,Qe),e(X,Xe),e(X,$e),e(X,et),e(X,tt),e(X,rt),e(X,at),e(X,lt),e(n,ot),e(n,he),e(he,Ee),e(Ee,fe),e(he,st),e(he,nt),e(he,it),e(he,ct),e(he,ht),e(s,dt),_e.m(s,null),e(s,Ae),e(s,$),e($,ut),e($,ft),e($,vt),e($,_t),e($,ze),e(ze,mt),e($,yt),e($,ve),e(ve,pt),e(ve,Me),e(Me,gt),e(ve,wt),e(ve,Ne),e(Ne,bt),e(ve,kt),e(ve,Ce),e(Ce,xt),e(ve,Et),e($,Ct),e($,Dt),e($,Tt),e($,It),Ue=!0},p(H,[ce]){Be===(Be=Ht(H))&&_e?_e.p(H,ce):(_e.d(1),_e=Be(H),_e&&(_e.c(),_e.m(s,Ae)))},i(H){Ue||(mr(r.$$.fragment,H),Ue=!0)},o(H){yr(r.$$.fragment,H),Ue=!1},d(H){pr(r,H),H&&i(l),H&&i(s),_e.d()}}}let K=500;const Ve=50,Gr=0,Fr=5,Hr=0,Wr=5;function Jr(o,r,l){let s,n={monthName:"February",monthNumber:2,year1:2024,year2:2025,day1:"2024-02-01",day2:"2025-02-28",day1_num:1,day2_num:28,update_date:"2025-03-24"},u=!0,y=null;async function W(){l(0,u=!0);try{const w=await(await fetch("/trend_canada_feb1_2024_to_feb28_2025.csv")).text();l(5,p=Sr(w)),l(6,te=[...new Set(p.map(N=>N.city))])}catch(g){console.error("Error loading CSV data:",g)}}let p=[];gr(()=>{W(),l(8,s=rr.filter(g=>g.region==="Canada").map(g=>g.city))});let Z;const x=Dr("%Y-%m-%d");let te=[],R=[],Q=[];console.log("thecities: ",te);function re(){Z=this.clientWidth,l(1,Z)}return o.$$.update=()=>{o.$$.dirty&256&&console.log("filteredCities: ",s),o.$$.dirty&368&&l(7,R=(()=>{if(y!==null)return y;const g=te.map(w=>{if(s.includes(w)){const N=p.filter(Y=>{const J=new Date(Y.date),G=new Date(n.day1),T=new Date(n.day2);return Y.city===w&&J>=G&&J<=T});if(N.length>0){console.log("cityData");const Y=N.map(a=>parseFloat(a.normalized_distinct_clean)),J=p.filter(a=>{const B=new Date(a.date+"T00:00:00Z");return B.getUTCFullYear()===n.year1&&B.getUTCMonth()===n.monthNumber-1&&a.city===w});console.log("month1data: ",J);const G=tr(J,a=>parseFloat(a.normalized_distinct_clean)),T=p.filter(a=>{const B=new Date(a.date+"T00:00:00Z");return B.getUTCFullYear()===n.year2&&B.getUTCMonth()===n.monthNumber-1&&a.city===w});console.log("month2data: ",T);const b=tr(T,a=>parseFloat(a.normalized_distinct_clean)),F=xr().x(a=>x(a.date)).y(a=>parseFloat(a.normalized_distinct_clean)).bandwidth(.031),oe=Math.min(...F(N).map(a=>a[1]),Ir(Y)),P=Math.max(...F(N).map(a=>a[1]),Mr(Y)),ae=Nr().domain([new Date(n.day1),new Date(n.day2)]).range([Wr,K-Fr]),z=Pr().domain([oe,P]).range([Ve-Hr,Gr]),L=Tr().x(a=>ae(a[0])).y(a=>z(a[1]))(F(N));w==="Quebec"&&(console.log(N),console.log(F(N)),console.log(P)),console.log("city: ",w),console.log("month1: ",G),console.log("month2: ",b);const A=(b-G)/G*100,se=A.toFixed(2)+"%";console.log("percentageChange: ",A);const S=F(N)[0],le={cx:ae(S[0]),cy:z(S[1]),radius:6,fill:"red",stroke:"red","stroke-width":2};console.log("cityData length:",N.length);const E=F(N)[391],m={cx:ae(E[0]),cy:z(E[1]),radius:6,fill:"red",stroke:"#6aa687","stroke-width":2},U=z(G);return{city:w,regressionLine:L,meanLine:U,startCircle:le,endCircle:m,perChangeDisplay:se,percentageChange:A}}}}).filter(w=>w!==void 0);return g.length>0&&(l(4,y=g),setTimeout(()=>{l(0,u=!1)},0)),g})()),o.$$.dirty&128&&l(2,Q=R.slice().sort((g,w)=>w.percentageChange-g.percentageChange))},l(8,s=rr.filter(g=>g.region==="Canada").map(g=>g.city)),[u,Z,Q,n,y,p,te,R,s,re]}class ra extends hr{constructor(r){super(),dr(this,r,Jr,Br,ur,{})}}export{ra as component,ta as universal};
