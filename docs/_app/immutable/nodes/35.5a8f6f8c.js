import{S as rt,i as nt,s as st,k as S,q as E,a as C,l as D,m as b,r as w,h as d,c as N,n as l,b as $,C as u,W as ot,N as it,D as Te,M as me,E as ve,y as Fe,K as J,e as ie,z as Ie,L as j,V as ht,A as Pe,X as ut,g as Ve,d as $e,B as Re,o as ct,u as ue,p as O}from"../chunks/index.5885d984.js";import{H as ft}from"../chunks/global.e1ff8cb9.js";import{d as qe,s as _t,r as pt}from"../chunks/stores.01dfc0ed.js";/* empty css                                                           */import{S as dt}from"../chunks/SelectRegions.4d7f2f4b.js";import{c as mt}from"../chunks/csv.3ac754ad.js";function Ke(e,t,r){const s=e.slice();return s[4]=t[r],s}function Ge(e){let t,r=e[4].name+"",s;return{c(){t=S("option"),s=E(r),this.h()},l(a){t=D(a,"OPTION",{class:!0});var i=b(t);s=w(i,r),i.forEach(d),this.h()},h(){t.__value=e[4].number,t.value=t.__value,l(t,"class","svelte-17uihdx")},m(a,i){$(a,t,i),u(t,s)},p:Te,d(a){a&&d(t)}}}function vt(e){let t,r,s,a,i,f,_=e[0],p=[];for(let o=0;o<_.length;o+=1)p[o]=Ge(Ke(e,_,o));return{c(){t=S("p"),r=E("Select Season:"),s=C(),a=S("select");for(let o=0;o<p.length;o+=1)p[o].c();this.h()},l(o){t=D(o,"P",{});var k=b(t);r=w(k,"Select Season:"),k.forEach(d),s=N(o),a=D(o,"SELECT",{class:!0});var v=b(a);for(let m=0;m<p.length;m+=1)p[m].l(v);v.forEach(d),this.h()},h(){l(a,"class","svelte-17uihdx")},m(o,k){$(o,t,k),u(t,r),$(o,s,k),$(o,a,k);for(let v=0;v<p.length;v+=1)p[v]&&p[v].m(a,null);ot(a,e[1]),i||(f=it(a,"change",e[2]),i=!0)},p(o,[k]){if(k&1){_=o[0];let v;for(v=0;v<_.length;v+=1){const m=Ke(o,_,v);p[v]?p[v].p(m,k):(p[v]=Ge(m),p[v].c(),p[v].m(a,null))}for(;v<p.length;v+=1)p[v].d(1);p.length=_.length}},i:Te,o:Te,d(o){o&&d(t),o&&d(s),o&&d(a),me(p,o),i=!1,f()}}}function gt(e,t,r){let s;ve(e,qe,_=>r(3,s=_));const a=[{name:"Spring: Mar 2020 - May 2020",number:1},{name:"Summer: June 2020 - Aug 2020",number:2},{name:"Fall: Sept 2020 - Nov 2020",number:3},{name:"Winter: Dec 2020 - Feb 2021",number:4},{name:"Spring: Mar 2021 - May 2021",number:5},{name:"Summer: June 2021 - Aug 2021",number:6},{name:"Fall: Sept 2021 - Nov 2021",number:7},{name:"Winter: Dec 2021 - Feb 2022",number:8},{name:"Spring: Mar 2022 - May 2022",number:9},{name:"Summer: June 2022 - Aug 2022",number:10},{name:"Fall: Sept 2022 - Nov 2022",number:11},{name:"Winter: Dec 2022 - Feb 2023",number:12}];let i=s;function f(_){const p=_.target.value;qe.set(p)}return[a,i,f]}class yt extends rt{constructor(t){super(),nt(this,t,gt,vt,st,{})}}const bt=!0,Ft=Object.freeze(Object.defineProperty({__proto__:null,prerender:bt},Symbol.toStringTag,{value:"Module"}));function Qe(e,t,r){const s=e.slice();return s[17]=t[r],s[19]=r,s}function Ue(e,t,r){const s=e.slice();return s[20]=t[r],s[19]=r,s}function Ye(e,t,r){const s=e.slice();return s[17]=t[r],s[19]=r,s}function Ze(e){let t,r,s,a,i,f,_,p=(100*e[17]).toFixed(0)+"",o,k,v;return{c(){t=J("line"),a=J("line"),_=J("text"),o=E(p),k=E("%"),this.h()},l(m){t=j(m,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0}),b(t).forEach(d),a=j(m,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0}),b(a).forEach(d),_=j(m,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var g=b(_);o=w(g,p),k=w(g,"%"),g.forEach(d),this.h()},h(){l(t,"class","grid svelte-ac7ppe"),l(t,"x1",r=29+e[19]*e[4]),l(t,"y1","34"),l(t,"x2",s=29+e[19]*e[4]),l(t,"y2",e[3]),l(a,"class","grid-white svelte-ac7ppe"),l(a,"x1",i=29+e[19]*e[4]),l(a,"y1","34"),l(a,"x2",f=29+e[19]*e[4]),l(a,"y2","38"),l(_,"class","axis-label svelte-ac7ppe"),l(_,"x",v=35+e[19]*e[4]),l(_,"y","30"),l(_,"text-anchor","end")},m(m,g){$(m,t,g),$(m,a,g),$(m,_,g),u(_,o),u(_,k)},p(m,g){g&16&&r!==(r=29+m[19]*m[4])&&l(t,"x1",r),g&16&&s!==(s=29+m[19]*m[4])&&l(t,"x2",s),g&8&&l(t,"y2",m[3]),g&16&&i!==(i=29+m[19]*m[4])&&l(a,"x1",i),g&16&&f!==(f=29+m[19]*m[4])&&l(a,"x2",f),g&4&&p!==(p=(100*m[17]).toFixed(0)+"")&&ue(o,p),g&16&&v!==(v=35+m[19]*m[4])&&l(_,"x",v)},d(m){m&&d(t),m&&d(a),m&&d(_)}}}function et(e){let t,r=e[20].display_title+"",s,a,i=Math.round(100*e[20].seasonal_average)+"",f,_;return{c(){t=J("text"),s=E(r),a=E(" - "),f=E(i),_=E("%"),this.h()},l(p){t=j(p,"text",{class:!0,x:!0,y:!0,style:!0});var o=b(t);s=w(o,r),a=w(o," - "),f=w(o,i),_=w(o,"%"),o.forEach(d),this.h()},h(){l(t,"class","bar-label svelte-ac7ppe"),l(t,"x","32"),l(t,"y",56+e[19]*24),O(t,"fill","#000"),O(t,"fill-opacity","0"),O(t,"stroke","white"),O(t,"stroke-width","3px"),O(t,"stroke-opacity","0.62")},m(p,o){$(p,t,o),u(t,s),u(t,a),u(t,f),u(t,_)},p(p,o){o&1&&r!==(r=p[20].display_title+"")&&ue(s,r),o&1&&i!==(i=Math.round(100*p[20].seasonal_average)+"")&&ue(f,i)},d(p){p&&d(t)}}}function tt(e){let t=e[5].find(L).text==="#000",r,s,a,i,f,_=e[19]+1+"",p,o,k=e[20].display_title+"",v,m,g=Math.round(100*e[20].seasonal_average)+"",W,R;function L(...c){return e[10](e[20],...c)}let M=t&&et(e);function K(...c){return e[11](e[20],...c)}function X(...c){return e[12](e[20],...c)}return{c(){M&&M.c(),r=J("line"),a=J("line"),f=J("text"),p=E(_),o=J("text"),v=E(k),m=E(" - "),W=E(g),R=E("%"),this.h()},l(c){M&&M.l(c),r=j(c,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,style:!0}),b(r).forEach(d),a=j(c,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,style:!0}),b(a).forEach(d),f=j(c,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var y=b(f);p=w(y,_),y.forEach(d),o=j(c,"text",{class:!0,x:!0,y:!0,style:!0});var A=b(o);v=w(A,k),m=w(A," - "),W=w(A,g),R=w(A,"%"),A.forEach(d),this.h()},h(){l(r,"class","bar"),l(r,"x1",29),l(r,"y1",52+e[19]*24),l(r,"x2",s=29+(e[1]-50)*e[20].seasonal_average/Math.max(...e[2])),l(r,"y2",52+e[19]*24),O(r,"stroke","white"),O(r,"stroke-width","20 "),l(a,"class","bar"),l(a,"x1",30),l(a,"y1",52+e[19]*24),l(a,"x2",i=29+(e[1]-50)*e[20].seasonal_average/Math.max(...e[2])-1),l(a,"y2",52+e[19]*24),O(a,"stroke",e[5].find(K).colour),O(a,"stroke-width","18"),l(f,"class","axis-label svelte-ac7ppe"),l(f,"x","25"),l(f,"y",57+e[19]*24),l(f,"text-anchor","end"),l(o,"class","bar-label svelte-ac7ppe"),l(o,"x","32"),l(o,"y",56+e[19]*24),O(o,"fill",e[5].find(X).text)},m(c,y){M&&M.m(c,y),$(c,r,y),$(c,a,y),$(c,f,y),u(f,p),$(c,o,y),u(o,v),u(o,m),u(o,W),u(o,R)},p(c,y){e=c,y&1&&(t=e[5].find(L).text==="#000"),t?M?M.p(e,y):(M=et(e),M.c(),M.m(r.parentNode,r)):M&&(M.d(1),M=null),y&7&&s!==(s=29+(e[1]-50)*e[20].seasonal_average/Math.max(...e[2]))&&l(r,"x2",s),y&7&&i!==(i=29+(e[1]-50)*e[20].seasonal_average/Math.max(...e[2])-1)&&l(a,"x2",i),y&1&&O(a,"stroke",e[5].find(K).colour),y&1&&k!==(k=e[20].display_title+"")&&ue(v,k),y&1&&g!==(g=Math.round(100*e[20].seasonal_average)+"")&&ue(W,g),y&1&&O(o,"fill",e[5].find(X).text)},d(c){M&&M.d(c),c&&d(r),c&&d(a),c&&d(f),c&&d(o)}}}function at(e){let t,r,s;return{c(){t=J("line"),this.h()},l(a){t=j(a,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,"stroke-opacity":!0,"stroke-dasharray":!0}),b(t).forEach(d),this.h()},h(){l(t,"class","grid-white svelte-ac7ppe"),l(t,"x1",r=29+e[19]*e[4]),l(t,"y1","34"),l(t,"x2",s=29+e[19]*e[4]),l(t,"y2",e[3]),l(t,"stroke-opacity","0.75"),l(t,"stroke-dasharray","2 2")},m(a,i){$(a,t,i)},p(a,i){i&16&&r!==(r=29+a[19]*a[4])&&l(t,"x1",r),i&16&&s!==(s=29+a[19]*a[4])&&l(t,"x2",s),i&8&&l(t,"y2",a[3])},d(a){a&&d(t)}}}function lt(e){let t,r,s,a,i=e[17]===1&&at(e);return{c(){t=J("line"),i&&i.c(),a=ie(),this.h()},l(f){t=j(f,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,"stroke-opacity":!0}),b(t).forEach(d),i&&i.l(f),a=ie(),this.h()},h(){l(t,"class","grid svelte-ac7ppe"),l(t,"x1",r=29+e[19]*e[4]),l(t,"y1","34"),l(t,"x2",s=29+e[19]*e[4]),l(t,"y2",e[3]),l(t,"stroke-opacity","0.21")},m(f,_){$(f,t,_),i&&i.m(f,_),$(f,a,_)},p(f,_){_&16&&r!==(r=29+f[19]*f[4])&&l(t,"x1",r),_&16&&s!==(s=29+f[19]*f[4])&&l(t,"x2",s),_&8&&l(t,"y2",f[3]),f[17]===1?i?i.p(f,_):(i=at(f),i.c(),i.m(a.parentNode,a)):i&&(i.d(1),i=null)},d(f){f&&d(t),i&&i.d(f),f&&d(a)}}}function kt(e){let t,r,s,a,i,f,_,p,o,k,v,m,g,W,R,L,M,K,X,c,y,A,G,ee,ge,ye,te,be,ke,Ee,T,z,Q,U,we,B,he,Me,Se,Y,De,Z,Ae,xe,x,ce,fe,Ce,ae;t=new ft({}),U=new yt({}),Y=new dt({props:{europe:"yes",canada:"yes"}});let le=e[2],F=[];for(let h=0;h<le.length;h+=1)F[h]=Ze(Ye(e,le,h));let re=e[0],I=[];for(let h=0;h<re.length;h+=1)I[h]=tt(Ue(e,re,h));let ne=e[2],P=[];for(let h=0;h<ne.length;h+=1)P[h]=lt(Qe(e,ne,h));return{c(){Fe(t.$$.fragment),r=C(),s=S("main"),a=S("div"),i=S("h3"),f=E("This is an archived version of our rankings data, for our most recent rankings, using updated data sources and methodology, click "),_=S("a"),p=E("here"),o=C(),k=S("h1"),v=E("Downtown Recovery Rankings"),m=C(),g=S("p"),W=E("The recovery metrics on these charts are based on a sample of mobile phone data."),R=C(),L=S("p"),M=E("They are computed by counting the number of unique mobile phones in a city's downtown area in the specified time period, and then dividing it by the number of unique visitors during the equivalent time period in 2019. For example, the March 2023 - May 2023 time period is compared to the March 2019 - May 2019 time period."),K=C(),X=S("p"),c=E("A recovery metric greater than 100% means that for the selected inputs, the mobile device activity increased relative to the comparison period. A value less than 100% means the opposite, that the city's downtown has not recovered to pre-COVID activity levels."),y=C(),A=S("p"),G=E("For more information, read our "),ee=S("a"),ge=E("Methodology"),ye=E(" page. Or click "),te=S("a"),be=E("here"),ke=E(" to download the data shown on this chart."),Ee=C(),T=S("div"),z=S("div"),Q=S("div"),Fe(U.$$.fragment),we=C(),B=S("div"),he=S("p"),Me=E("Select Regions:"),Se=C(),Fe(Y.$$.fragment),De=C(),Z=S("p"),Ae=E("*Data for Europe is only available from 12/2021 to 02/2023"),xe=C(),x=J("svg");for(let h=0;h<F.length;h+=1)F[h].c();ce=ie();for(let h=0;h<I.length;h+=1)I[h].c();fe=ie();for(let h=0;h<P.length;h+=1)P[h].c();this.h()},l(h){Ie(t.$$.fragment,h),r=N(h),s=D(h,"MAIN",{class:!0});var V=b(s);a=D(V,"DIV",{class:!0});var n=b(a);i=D(n,"H3",{});var q=b(i);f=w(q,"This is an archived version of our rankings data, for our most recent rankings, using updated data sources and methodology, click "),_=D(q,"A",{href:!0});var Ne=b(_);p=w(Ne,"here"),Ne.forEach(d),q.forEach(d),o=N(n),k=D(n,"H1",{});var Oe=b(k);v=w(Oe,"Downtown Recovery Rankings"),Oe.forEach(d),m=N(n),g=D(n,"P",{});var We=b(g);W=w(We,"The recovery metrics on these charts are based on a sample of mobile phone data."),We.forEach(d),R=N(n),L=D(n,"P",{});var ze=b(L);M=w(ze,"They are computed by counting the number of unique mobile phones in a city's downtown area in the specified time period, and then dividing it by the number of unique visitors during the equivalent time period in 2019. For example, the March 2023 - May 2023 time period is compared to the March 2019 - May 2019 time period."),ze.forEach(d),K=N(n),X=D(n,"P",{});var He=b(X);c=w(He,"A recovery metric greater than 100% means that for the selected inputs, the mobile device activity increased relative to the comparison period. A value less than 100% means the opposite, that the city's downtown has not recovered to pre-COVID activity levels."),He.forEach(d),y=N(n),A=D(n,"P",{});var se=b(A);G=w(se,"For more information, read our "),ee=D(se,"A",{href:!0});var Je=b(ee);ge=w(Je,"Methodology"),Je.forEach(d),ye=w(se," page. Or click "),te=D(se,"A",{href:!0});var je=b(te);be=w(je,"here"),je.forEach(d),ke=w(se," to download the data shown on this chart."),se.forEach(d),n.forEach(d),Ee=N(V),T=D(V,"DIV",{id:!0,class:!0});var _e=b(T);z=D(_e,"DIV",{id:!0,class:!0});var oe=b(z);Q=D(oe,"DIV",{id:!0,class:!0});var Le=b(Q);Ie(U.$$.fragment,Le),Le.forEach(d),we=N(oe),B=D(oe,"DIV",{id:!0,class:!0});var pe=b(B);he=D(pe,"P",{});var Xe=b(he);Me=w(Xe,"Select Regions:"),Xe.forEach(d),Se=N(pe),Ie(Y.$$.fragment,pe),pe.forEach(d),De=N(oe),Z=D(oe,"P",{id:!0,class:!0});var Be=b(Z);Ae=w(Be,"*Data for Europe is only available from 12/2021 to 02/2023"),Be.forEach(d),oe.forEach(d),xe=N(_e),x=j(_e,"svg",{height:!0,width:!0,id:!0,class:!0});var de=b(x);for(let H=0;H<F.length;H+=1)F[H].l(de);ce=ie();for(let H=0;H<I.length;H+=1)I[H].l(de);fe=ie();for(let H=0;H<P.length;H+=1)P[H].l(de);de.forEach(d),_e.forEach(d),V.forEach(d),this.h()},h(){l(_,"href","/charts/rankings"),l(ee,"href","/methodology"),l(te,"href","/ranking_data_archived.csv"),l(a,"class","text"),l(Q,"id","options-season"),l(Q,"class","svelte-ac7ppe"),l(B,"id","options-region"),l(B,"class","svelte-ac7ppe"),l(Z,"id","note"),l(Z,"class","svelte-ac7ppe"),l(z,"id","options"),l(z,"class","svelte-ac7ppe"),l(x,"height",e[3]),l(x,"width",e[1]),l(x,"id","chart"),l(x,"class","svelte-ac7ppe"),l(T,"id","chart-wrapper"),l(T,"class","svelte-ac7ppe"),ht(()=>e[13].call(T)),l(s,"class","svelte-ac7ppe")},m(h,V){Pe(t,h,V),$(h,r,V),$(h,s,V),u(s,a),u(a,i),u(i,f),u(i,_),u(_,p),u(a,o),u(a,k),u(k,v),u(a,m),u(a,g),u(g,W),u(a,R),u(a,L),u(L,M),u(a,K),u(a,X),u(X,c),u(a,y),u(a,A),u(A,G),u(A,ee),u(ee,ge),u(A,ye),u(A,te),u(te,be),u(A,ke),u(s,Ee),u(s,T),u(T,z),u(z,Q),Pe(U,Q,null),u(z,we),u(z,B),u(B,he),u(he,Me),u(B,Se),Pe(Y,B,null),u(z,De),u(z,Z),u(Z,Ae),u(T,xe),u(T,x);for(let n=0;n<F.length;n+=1)F[n]&&F[n].m(x,null);u(x,ce);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(x,null);u(x,fe);for(let n=0;n<P.length;n+=1)P[n]&&P[n].m(x,null);Ce=ut(T,e[13].bind(T)),ae=!0},p(h,[V]){if(V&28){le=h[2];let n;for(n=0;n<le.length;n+=1){const q=Ye(h,le,n);F[n]?F[n].p(q,V):(F[n]=Ze(q),F[n].c(),F[n].m(x,ce))}for(;n<F.length;n+=1)F[n].d(1);F.length=le.length}if(V&39){re=h[0];let n;for(n=0;n<re.length;n+=1){const q=Ue(h,re,n);I[n]?I[n].p(q,V):(I[n]=tt(q),I[n].c(),I[n].m(x,fe))}for(;n<I.length;n+=1)I[n].d(1);I.length=re.length}if(V&28){ne=h[2];let n;for(n=0;n<ne.length;n+=1){const q=Qe(h,ne,n);P[n]?P[n].p(q,V):(P[n]=lt(q),P[n].c(),P[n].m(x,null))}for(;n<P.length;n+=1)P[n].d(1);P.length=ne.length}(!ae||V&8)&&l(x,"height",h[3]),(!ae||V&2)&&l(x,"width",h[1])},i(h){ae||(Ve(t.$$.fragment,h),Ve(U.$$.fragment,h),Ve(Y.$$.fragment,h),ae=!0)},o(h){$e(t.$$.fragment,h),$e(U.$$.fragment,h),$e(Y.$$.fragment,h),ae=!1},d(h){Re(t,h),h&&d(r),h&&d(s),Re(U),Re(Y),me(F,h),me(I,h),me(P,h),Ce()}}}function Et(e,t,r){let s,a,i,f;ve(e,_t,c=>r(8,a=c)),ve(e,qe,c=>r(9,i=c)),ve(e,pt,c=>r(14,f=c));let _=[],p=[];const o=f;async function k(){try{const y=await(await fetch("/ranking_data_archived.csv")).text();r(6,_=mt(y))}catch(c){console.error("Error loading CSV data:",c)}}ct(()=>{k()});let v,m=100,g=1;function W(c,y){let A=[];for(let G=0;G<=Math.ceil(c/y);G++)A.push(G*y);return A}let R=[];const L=(c,y)=>y.name===c.region,M=(c,y)=>y.name===c.region,K=(c,y)=>y.name===c.region;function X(){v=this.offsetWidth,r(1,v)}return e.$$.update=()=>{e.$$.dirty&832&&r(0,p=_.filter(c=>c.metric==="downtown").filter(c=>c.Season===`Season_${i}`).filter(c=>a.includes(c.region)).sort((c,y)=>y.seasonal_average-c.seasonal_average)),e.$$.dirty&1&&r(3,m=24*p.length+50),e.$$.dirty&1&&r(7,g=p.length!==0?p[0].seasonal_average:1),e.$$.dirty&128&&r(7,g=g<1?1:g),e.$$.dirty&128&&(g<2?r(2,R=W(g,.2)):r(2,R=W(g,.5))),e.$$.dirty&6&&r(4,s=(v-50)/(R.length-1))},[p,v,R,m,s,o,_,g,a,i,L,M,K,X]}class It extends rt{constructor(t){super(),nt(this,t,Et,kt,st,{})}}export{It as component,Ft as universal};
